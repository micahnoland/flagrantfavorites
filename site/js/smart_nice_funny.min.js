var teams=[{name:"San Antonio Spurs",code:"SAS",funny:!1,shortName:"spurs"},{name:"Boston Celtics",code:"BOS",funny:!1,shortName:"celtics"},{name:"Brooklyn Nets",code:"BKN",funny:!0,shortName:"nets"},{name:"New York Knicks",code:"NYK",funny:!1,shortName:"knicks"},{name:"Philadelphia 76ers",code:"PHI",funny:!0,shortName:"sixers"},{name:"Toronto Raptors",code:"TOR",funny:!0,shortName:"raptors"},{name:"Chicago Bulls",code:"CHI",funny:!1,shortName:"bulls"},{name:"Cleveland Cavaliers",code:"CLE",funny:!0,shortName:"cavaliers"},{name:"Detroit Pistons",code:"DET",funny:!0,shortName:"pistons"},{name:"Indiana Pacers",code:"IND",funny:!0,shortName:"pacers"},{name:"Milwaukee Bucks",code:"MIL",funny:!0,shortName:"bucks"},{name:"Atlanta Hawks",code:"ATL",funny:!0,shortName:"hawks"},{name:"Charlotte Hornets",code:"CHA",funny:!0,shortName:"hornets"},{name:"Miami Heat",code:"MIA",funny:!0,shortName:"heat"},{name:"Orlando Magic",code:"ORL",funny:!0,shortName:"magic"},{name:"Washington Wizards",code:"WAS",funny:!0,shortName:"wizards"},{name:"Denver Nuggets",code:"DEN",funny:!0,shortName:"nuggets"},{name:"Minnesota Timberwolves",code:"MIN",funny:!0,shortName:"timberwolves"},{name:"Oklahoma City Thunder",code:"OKC",funny:!1,shortName:"thunder"},{name:"Portland Trail Blazers",code:"POR",funny:!0,shortName:"blazers"},{name:"Utah Jazz",code:"UTA",funny:!0,shortName:"jazz"},{name:"Golden State Warriors",code:"GSW",funny:!1,shortName:"warriors"},{name:"Los Angeles Clippers",code:"LAC",funny:!1,shortName:"clippers"},{name:"Los Angeles Lakers",code:"LAL",funny:!1,shortName:"lakers"},{name:"Phoenix Suns",code:"PHX",funny:!0,shortName:"suns"},{name:"Sacramento Kings",code:"SAC",funny:!0,shortName:"kings"},{name:"Dallas Mavericks",code:"DAL",funny:!0,shortName:"mavericks"},{name:"Houston Rockets",code:"HOU",funny:!0,shortName:"rockets"},{name:"Memphis Grizzlies",code:"MEM",funny:!0,shortName:"grizzlies"},{name:"New Orleans Pelicans",code:"NOP",funny:!0,shortName:"pelicans"}];var onlyFunnyPlayersSorry={"DeAndre Jordan":!1,"Klay Thompson":!1,"Kyrie Irving":!1,"Jonathan Issac":!1,"Taurean Prince":!1,"Trae Young":!1,"Jaylen Brown":!1,"Jayson Tatum":!1,"Rondae Hollis-Jefferson":!1,"Caris LeVert":!1,"Kemba Walker":!1,"Miles Bridges":!1,"Lauri Markkanen":!1,"Wendell Carter Jr.":!1,"Kevin Love":!1,"Collin Sexton":!1,"Dennis Smith Jr.":!1,"Luka Doncic":!1,"Jamal Murray":!1,"Nikola Jokic":!1,"Andre Drummond":!1,"Blake Griffin":!1,"Stephen Curry":!1,"Kevin Durant":!1,"James Harden":!1,"Chris Paul":!1,"Myles Turner":!1,"Victor Oladipo":!1,"Myles Turner":!1,"Tobias Harris":!1,"Shai Gilgeous-Alexander":!1,"Brandon Ingram":!1,"LeBron James":!1,"Marc Gasol":!1,"Jaren Jackson Jr.":!1,"Justise Winslow":!1,"Bam Adebayo":!1,"Giannis Antetokounmpo":!1,"Khris Middleton":!1,"Karl-Anthony Towns":!1,"Jimmy Butler":!1,"Anthony Davis":!1,"Julius Randle":!1,"Kristaps Porzingis":!1,"Kevin Knox":!1,"Russell Westbrook":!1,"Paul George":!1,"Mohamed Bamba":!1,"Aaron Gordon":!1,"Joel Embiid":!1,"Ben Simmons":!1,"Deandre Ayton":!1,"Devin Booker":!1,"Damian Lillard":!1,"CJ McCollum":!1,"De'Aaron Fox":!1,"Marvin Bagley III":!1,"LaMarcus Aldridge":!1,"DeMar DeRozan":!1,"Kawhi Leonard":!1,"OG Anunoby":!1,"Rudy Gobert":!1,"Donovan Mitchell":!1,"John Wall":!1,"Bradley Beal":!1};var allPlayers=[];var favteam,favplayer;var favteamPick,favplayerPick;const playerPicPrefix='https://ak-static.cms.nba.com/wp-content/uploads/headshots/nba/latest/260x190/';$(document).ready(function(){$('#loading').hide();const loadTeamImagesPromise=loadTeamImages().then(()=>{favteam=$('#favteam').slotMachine({active:0,randomize(){return pickTeam()}})});const loadPlayersPromise=loadPlayers().then(()=>{favplayer=$('#favplayer').slotMachine({active:0,randomize(){return 1}})});Promise.all([loadTeamImagesPromise,loadPlayersPromise]).then(()=>{$('#letsgo').on('click',function(event){clearFavTexts();pickPlayer().then(()=>{roll();event.preventDefault()})})})});function roll(){favplayer.prev();Promise.all([rollTeam(),rollPlayer()]).then(()=>{updateTweetButton(favteamPick.name,favplayerPick[2])})}
function rollTeam(){return new Promise(resolve=>{favteam.shuffle(5,function(){setFavTeamText(favteamPick);resolve()})})}
function rollPlayer(){return new Promise(resolve=>{setTimeout(()=>favplayer.shuffle(5,function(){setFavPlayerText(favplayerPick);resolve()}),500)})}
function clearFavTexts(){$('#favteamname').fadeOut('fast',function(){$(this).empty()});$('#favplayername').fadeOut('fast',function(){$(this).empty()});$('#tweet').fadeOut('fast',function(){$(this).empty()})}
function setFavTeamText(favteamPick){var anchor=$('<a>',{text:'The '+favteamPick.name+'!',href:'http://www.nba.com/teams/'+favteamPick.shortName});const favteamname=$('#favteamname');favteamname.append(anchor);favteamname.fadeIn(500)}
function setFavPlayerText(favplayerPick){var anchor=$('<a>',{text:favplayerPick[2]+'!',href:'https://stats.nba.com/player/'+favplayerPick[0]});const favplayername=$('#favplayername');favplayername.append(anchor);favplayername.fadeIn(500)}
function loadTeamImages(){return new Promise(resolve=>{teams.forEach(function(team){$('#favteam').append($('<img>',{class:'team',src:'https://www.nba.com/assets/logos/teams/secondary/web/'+team.code+'.svg#'+team.code+'(viewBox(0, 0, 250, 250))'}))});resolve()})}
function loadPlayers(){return new Promise(resolve=>{fetchPlayers().done(handlePlayers).then(resolve)})}
function getRandomSubarray(arr,size){return new Promise(resolve=>{var shuffled=arr.slice(0),i=arr.length,temp,index;while(i--){index=Math.floor((i+1)*Math.random());temp=shuffled[index];shuffled[index]=shuffled[i];shuffled[i]=temp}
resolve(shuffled.slice(0,size))})}
function pickTeam(){var teamPickIndex=getRandomTeamIndex();while(teams[teamPickIndex].funny===!1){teamPickIndex=getRandomTeamIndex()}
favteamPick=teams[teamPickIndex];return teamPickIndex+1}
function getRandomTeamIndex(){return Math.floor(Math.random()*teams.length)}
function pickPlayer(){return new Promise(resolve=>{var secretPick=getRandomPlayer();while(onlyFunnyPlayersSorry[secretPick[2]]===!1){secretPick=getRandomPlayer()}
var nextRandom=getRandomPlayer();$('.slotMachineContainer .player:nth-child(3)').attr('src',playerPicPrefix+secretPick[0]+".png");$('.slotMachineContainer .player:nth-child(6)').attr('src',playerPicPrefix+nextRandom[0]+".png");favplayerPick=secretPick;resolve()})}
function getRandomPlayer(){return allPlayers[Math.floor(Math.random()*allPlayers.length)]}
function fetchPlayers(){var date=new Date();var year=2019;var month=1;var nextYear=(year+1).toString().substr(-2);if(month>=0&&month<=9){year=year-1;nextYear=nextYear-1}
var url='https://stats.nba.com/stats/commonallplayers?LeagueID=00&IsOnlyCurrentSeason=1&Season='+year+'-'+nextYear;return $.ajax({url:url,type:'GET',dataType:'jsonp'})}
function handlePlayers(response){return new Promise(resolve=>{response.resultSets.forEach((resultSet)=>{resultSet.rowSet.forEach((rowSet)=>{allPlayers.push(rowSet)})});getRandomSubarray(allPlayers,30).then(loadCandidates).then(resolve)})}
function loadCandidates(candidates){return new Promise(resolve=>{candidates.forEach((candidate)=>{const imageUrl=playerPicPrefix+candidate[0]+'.png';$('#favplayer').append($('<img>',{class:'player',src:imageUrl,onerror:'this.onerror=null;this.src="img/notfound.png";'}))});resolve()})}
function updateTweetButton(team,player){var message='My new favorite NBA team is The '+team+' and my new favorite player is '+player+'! ';var tweetButton=$('<a>',{href:'https://twitter.com/intent/tweet?text='+message+'&url=https://flagrantfavorites.com&hashtags=TheFlagrantOnes',class:'btn btn-twitter twitter-share-button',}).text(' Tweet your new favorite team and player!');var icon=$('<i>',{class:'fa fa-twitter'});tweetButton.prepend(icon);tweetButton.attr('data-show-count','false');tweetButton.attr('data-size','large');$('#tweet').append(tweetButton);$('#tweet').fadeIn()}